(()=>{var r=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var h=(n,t,e)=>t in n?r(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,_=(n,t)=>{for(var e in t||={})g.call(t,e)&&h(n,e,t[e]);if(f)for(var e of f(t))C.call(t,e)&&h(n,e,t[e]);return n};var P=(n,t)=>{for(var e in t)r(n,e,{get:t[e],enumerable:!0})},A=(n,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of v(t))!g.call(n,a)&&a!==e&&r(n,a,{get:()=>t[a],enumerable:!(o=S(t,a))||o.enumerable});return n};var R=n=>A(r({},"__esModule",{value:!0}),n);var l=(n,t,e)=>new Promise((o,a)=>{var c=s=>{try{p(e.next(s))}catch(m){a(m)}},u=s=>{try{p(e.throw(s))}catch(m){a(m)}},p=s=>s.done?o(s.value):Promise.resolve(s.value).then(c,u);p((e=e.apply(n,t)).next())});var O={};P(O,{onLoad:()=>I,onUnload:()=>L});var{flux:{dispatcher:k},ui:{showToast:y}}=shelter,i,d={};function T(n){return l(this,null,function*(){return{name:"none"}})}function x(n,t){return l(this,null,function*(){return["none"]})}function w(n,t){return l(this,null,function*(){return(yield x(n,[t]))[0]})}function b(n){return l(this,null,function*(){var o,a;let t=JSON.parse(n.data),e=(o=t.activity)==null?void 0:o.assets;if(e!=null&&e.large_image&&(e.large_image=yield w(t.activity.application_id,e.large_image)),e!=null&&e.small_image&&(e.small_image=yield w(t.activity.application_id,e.small_image)),t.activity){let c=t.activity.application_id;d[c]||(d[c]=yield T(c));let u=d[c];(a=t.activity).name||(a.name=u.name)}k.dispatch(_({type:"LOCAL_ACTIVITY_UPDATE"},t))})}var I=()=>l(void 0,null,function*(){i&&i.close(),i=new WebSocket("ws://127.0.0.1:1337"),i.onmessage=b,(yield new Promise(t=>setTimeout(()=>{i.readyState!==WebSocket.OPEN&&(i.close(),i=null,y({title:"ShelteRPC",content:"Unable to connect to ShelteRPC server",duration:3e3}),t(!1)),t(!0)},1e3)))&&(i.onclose=()=>{y({title:"ShelteRPC",content:"ShelteRPC server disconnected",duration:3e3})},y({title:"ShelteRPC",content:"Connected to ShelteRPC server",duration:3e3}))}),L=()=>{i.close()};return R(O);})();
