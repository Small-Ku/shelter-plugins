(()=>{var v=Object.create;var r=Object.defineProperty,x=Object.defineProperties,D=Object.getOwnPropertyDescriptor,G=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,U=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var N=(t,e,n)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E=(t,e)=>{for(var n in e||={})T.call(e,n)&&N(t,n,e[n]);if(g)for(var n of g(e))F.call(e,n)&&N(t,n,e[n]);return t},I=(t,e)=>x(t,G(e));var L=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),q=(t,e)=>{for(var n in e)r(t,n,{get:e[n],enumerable:!0})},m=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of P(e))!T.call(t,o)&&o!==n&&r(t,o,{get:()=>e[o],enumerable:!(i=D(e,o))||i.enumerable});return t};var H=(t,e,n)=>(n=t!=null?v(U(t)):{},m(e||!t||!t.__esModule?r(n,"default",{value:t,enumerable:!0}):n,t)),J=t=>m(r({},"__esModule",{value:!0}),t);var c=(t,e,n)=>new Promise((i,o)=>{var k=s=>{try{d(n.next(s))}catch(_){o(_)}},A=s=>{try{d(n.throw(s))}catch(_){o(_)}},d=s=>s.done?i(s.value):Promise.resolve(s.value).then(k,A);d((n=n.apply(t,e)).next())});var w=L((V,b)=>{b.exports=shelter.solidWeb});var K={};q(K,{onLoad:()=>z,onUnload:()=>B});var C=H(w(),1);var{ui:{SwitchItem:M},flux:{dispatcher:f},solid:{createSignal:j},observeDom:W,patcher:X}=shelter,{invoke:h,notification:u}=window.__TAURI__,[l,O]=j(null),$='div[class*="contentColumn"] div[class*="container"]',a=null,p=!1,S=!1,y=t=>c(void 0,null,function*(){if(t.section!=="Notifications"){p=!1,S=!1;return}else if(p)return;p=!0,a=W($,e=>{if(a.now(),e.style.display="none",S)return;let n=(0,C.createComponent)(M,{note:"If you're looking for per-channel or per-server notifications, right-click the desired server icon and select Notification Settings.",get value(){var i;return(i=l())==null?void 0:i.desktop_notifications},onChange:i=>c(void 0,null,function*(){O(I(E({},l()),{desktop_notifications:i})),yield h("write_config_file",{contents:JSON.stringify(l())})}),children:"Enable Desktop Notifications"});e.parentElement.prepend(n),S=!0})}),R=t=>c(void 0,null,function*(){var n;let e=yield u.isPermissionGranted();if(e||(console.log("Requesting permission..."),e=(yield u.requestPermission())==="granted"),!e)return console.log("No notification permissions!");(n=l())!=null&&n.desktop_notifications&&u.sendNotification({title:t.title,body:t.body,icon:t.icon})});f.subscribe("USER_SETTINGS_MODAL_SET_SECTION",y);f.subscribe("RPC_NOTIFICATION_CREATE",R);var z=()=>c(void 0,null,function*(){O(JSON.parse(yield h("read_config_file")))}),B=()=>{a==null||a.now(),f.unsubscribe("USER_SETTINGS_MODAL_SET_SECTION",y),f.unsubscribe("RPC_NOTIFICATION_CREATE",R)};return J(K);})();
