(()=>{var k=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var f=(s,e)=>{for(var a in e)k(s,a,{get:e[a],enumerable:!0})},D=(s,e,a,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of m(e))!v.call(s,t)&&t!==a&&k(s,t,{get:()=>e[t],enumerable:!(o=S(e,t))||o.enumerable});return s};var A=s=>D(k({},"__esModule",{value:!0}),s);var c=(s,e,a)=>new Promise((o,t)=>{var l=r=>{try{i(a.next(r))}catch(b){t(b)}},T=r=>{try{i(a.throw(r))}catch(b){t(b)}},i=r=>r.done?o(r.value):Promise.resolve(r.value).then(l,T);i((a=a.apply(s,e)).next())});var x={};f(x,{onUnload:()=>U});var u=s=>{let e="";switch(s){case 8:e="Backspace";break;case 9:e="Tab";break;case 13:e="Enter";break;case 16:e="Shift";break;case 17:e="Control";break;case 18:e="Alt";break;case 20:e="CapsLock";break;case 27:e="Escape";break;case 32:e="Space";break;case 33:e="PageUp";break;case 34:e="PageDown";break;case 35:e="End";break;case 36:e="Home";break;case 37:e="Left";break;case 38:e="Up";break;case 39:e="Right";break;case 40:e="Down";break;case 45:e="Insert";break;case 46:e="Delete";break;default:e=String.fromCharCode(s);break}return e};var{flux:{dispatcher:n,stores:{UserStore:p}},observeDom:g}=shelter,{invoke:_,event:C}=window.__TAURI__,h=[],y=[],E=[],H='div[class*="pttToolsMessage_"]',L='div[class*="layerContainer_"] div[class*="layer_"]',d=()=>E.forEach(s=>s()),w=s=>c(void 0,null,function*(){if(s.section!=="Voice & Video"){d();return}E.push(g(H,e=>{e.remove()}),g(L,e=>{e.parentElement.innerHTML=""}))}),I=s=>c(void 0,null,function*(){let{mode:e,options:{shortcut:a}}=s,t=a.map(l=>l[1]).map(u);_("save_ptt_keys",{keys:t}),_("toggle_ptt",{state:e==="PUSH_TO_TALK"})}),P=s=>c(void 0,null,function*(){var o;let{state:e}=s.payload,a={type:"SPEAKING",context:"default",userId:(o=p==null?void 0:p.getCurrentUser())==null?void 0:o.id,speakingFlags:e?1:0};console.log("Toggle handler called with state: ",e),console.log(s.payload),n.dispatch(a)});y.push(n.subscribe("USER_SETTINGS_MODAL_SET_SECTION",w),n.subscribe("LAYER_POP",d),n.subscribe("AUDIO_SET_MODE",I));C.listen("ptt_toggle",P).then(s=>h.push(s));var U=()=>{d(),h.forEach(s=>s()),y.forEach(s=>s())};return A(x);})();
