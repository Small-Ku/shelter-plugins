(()=>{var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var m=(s,e)=>{for(var t in e)d(s,t,{get:e[t],enumerable:!0})},x=(s,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of T(e))!f.call(s,o)&&o!==t&&d(s,o,{get:()=>e[o],enumerable:!(a=S(e,o))||a.enumerable});return s};var D=s=>x(d({},"__esModule",{value:!0}),s);var r=(s,e,t)=>new Promise((a,o)=>{var i=c=>{try{b(t.next(c))}catch(k){o(k)}},E=c=>{try{b(t.throw(c))}catch(k){o(k)}},b=c=>c.done?a(c.value):Promise.resolve(c.value).then(i,E);b((t=t.apply(s,e)).next())});var U={};m(U,{onUnload:()=>P});var _=s=>{let e="";switch(s){case 8:e="Backspace";break;case 9:e="Tab";break;case 13:e="Enter";break;case 16:e="Shift";break;case 17:e="Control";break;case 18:e="Alt";break;case 20:e="CapsLock";break;case 27:e="Escape";break;case 32:e="Space";break;case 33:e="PageUp";break;case 34:e="PageDown";break;case 35:e="End";break;case 36:e="Home";break;case 37:e="Left";break;case 38:e="Up";break;case 39:e="Right";break;case 40:e="Down";break;case 45:e="Insert";break;case 46:e="Delete";break;default:e=String.fromCharCode(s);break}return e};var{flux:{dispatcher:l,stores:{UserStore:p}},observeDom:n}=shelter,{invoke:g,event:C}=window.__TAURI__,v=[],h=[],y=[],H='div[class*="pttToolsMessage_"]',L='div[class*="radioBar_"]',A='div[class*="layerContainer_"] div[class*="layer_"]',u=()=>y.forEach(s=>s()),w=s=>r(void 0,null,function*(){if(s.section!=="Voice & Video"){u();return}y.push(n(H,e=>{e.remove()}),n(A,e=>{let t=n('div[class*="backdrop_"]',a=>{a.click(),t()})}),n(L,e=>{let t='div[class*="info_"] div[class*="text"]',a=e.querySelector(t);a.textContent.includes("(")&&(a.textContent=a.textContent.replace(/\(.+?\)/g,""))}))}),I=s=>r(void 0,null,function*(){let{mode:e,options:{shortcut:t}}=s,o=t.map(i=>i[1]).map(_);g("save_ptt_keys",{keys:o}),g("toggle_ptt",{state:e==="PUSH_TO_TALK"})}),M=s=>r(void 0,null,function*(){var a;let{state:e}=s.payload,t={type:"SPEAKING",context:"default",userId:(a=p==null?void 0:p.getCurrentUser())==null?void 0:a.id,speakingFlags:e?1:0};console.log("Toggle handler called with state: ",e),l.dispatch(t)});h.push(l.subscribe("USER_SETTINGS_MODAL_SET_SECTION",w),l.subscribe("LAYER_POP",u),l.subscribe("AUDIO_SET_MODE",I));C.listen("ptt_toggle",M).then(s=>v.push(s));var P=()=>{u(),v.forEach(s=>s()),h.forEach(s=>s())};return D(U);})();
